<!--
 ~
 ~ This file is part of Hopsworks
 ~ Copyright (C) 2019, Logical Clocks AB. All rights reserved
 ~
 ~ Hopsworks is free software: you can redistribute it and/or modify it under the terms of
 ~ the GNU Affero General Public License as published by the Free Software Foundation,
 ~ either version 3 of the License, or (at your option) any later version.
 ~
 ~ Hopsworks is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 ~ without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
 ~ PURPOSE.  See the GNU Affero General Public License for more details.
 ~
 ~ You should have received a copy of the GNU Affero General Public License along with this program.
 ~ If not, see <https://www.gnu.org/licenses/>.
 ~
 -->
<div class="container">
    <div class="panel panel-default j-panel">
        <div class="panel-heading j-panel-heading">
            <div class="row">
                <div class="pull-right" style="margin-right: 10px">
                    <button class="btn btn-primary" ng-click="jupyterCtrl.start()" type="button"
                            id="newNotebook"  style="width:90px; font-weight: bolder" ng-show="!sparkConfigCtrl.uneditableMode">
                        Start <i class="fa fa-play" aria-hidden="true" style="margin-left: 5px"></i>
                    </button>
                </div>
            </div>
        </div>
        <div class="panel-body j-panel-body" ng-class="{uneditable:sparkConfigCtrl.uneditableMode}">
            <uib-tabset active="indextab" ng-init="sparkConfigCtrl.isJupyter = true;">
                <uib-tab index="0" heading="Python" ng-click="sparkConfigCtrl.changeTab('PYTHON')">
                    <div class="row">
                        <div class="col-sm-8">
                            <h2 class="j-tab-heading">Python</h2>
                            <p>In Python mode your code will be running on a single machine with the specified
                                number of CPUs and GPUs.</p>
                            <div ng-include="'views/jupyter/pythonConfig.html'"></div>
                        </div>
                        <div class="col-sm-4 description">
                            <p> When you start a Jupyter notebook server you have the possibility
                                to specify resource needed for your container running the notebook
                                server.
                            </p>
                            <p> Jupyter notebook will behave identical to how it would
                                if you start the notebook server locally on your machine using a
                                python kernel, without access to a Hadoop cluster. </p>
                            <p>Want to Learn More? Read the
                                <a href="https://hops.readthedocs.io/en/0.9/user_guide/hopsworks/jupyter.html?highlight=jupyt">docs.</a>
                            </p>
                        </div>
                    </div>
                </uib-tab>
                <uib-tab index="1" heading="Experiments"
                         ng-click="sparkConfigCtrl.changeTab('EXPERIMENT')">
                    <div class="row">
                        <div class="col-sm-8">
                            <h2 class="j-tab-heading">Experiments</h2>
                            <p> Run experiments to identify the right combination
                                of hyperparameters to optimize the performance of your model.</p>
                            <md-radio-group ng-model="sparkConfigCtrl.jobConfig.experimentType">
                                <table class="button-table">
                                    <tbody>
                                    <tr>
                                        <td>
                                            <md-radio-button value="EXPERIMENT" class="md-primary">Experiment</md-radio-button>
                                        </td>
                                        <td>
                                            <md-radio-button value="PARALLEL_EXPERIMENTS" class="md-primary">Parallel Experiments</md-radio-button>
                                        </td>
                                        <td>
                                            <md-radio-button value="DISTRIBUTED_TRAINING" class="md-primary">Distributed Training</md-radio-button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </md-radio-group>
                            <div ng-include="'views/jupyter/experimentConfig.html'"></div>
                        </div>
                        <div class="col-sm-4 description">
                            <div ng-if="sparkConfigCtrl.jobConfig.experimentType == 'EXPERIMENT'">
                                <p class="j-tab-advanced">Experiment</p>
                                <p> The simple Experiment abstraction corresponds to a single Python
                                    ML program, for example any hyperparameters or other
                                    configuration is hard-coded in the code itself.</p>
                                <p>Want to Learn More? Read the
                                    <a href="https://hops.readthedocs.io/en/0.9/hopsml/experiment.html">docs.</a>
                                </p>
                            </div>
                            <div ng-if="sparkConfigCtrl.jobConfig.experimentType == 'PARALLEL_EXPERIMENTS'">
                                <p class="j-tab-advanced">Parallel Experiments</p>
                                <p> Hyperparameter optimization is critical to achieve the best
                                    accuracy for your model. With HopsML, hyperparameter
                                    optimization is easier than ever. We provide grid-search or
                                    state-of-the-art evolutionary optimization which will
                                    automatically learn what hyperparameters are the best and
                                    iteratively improve metrics such as model accuracy.</p>
                            </div>
                            <div ng-if="sparkConfigCtrl.jobConfig.experimentType == 'DISTRIBUTED_TRAINING'">
                                <p class="j-tab-advanced">Distributed Training</p>
                                <p>Compared to Experiment and Parallel Experiments, Distributed
                                    Training involves making use of multiple machines with
                                    potentially multiple GPUs per machine in order to train the
                                    model.
                                </p>
                                <p> HopsML supports the newly released MirroredStrategy,
                                    ParameterServerStrategy and CollectiveAllReduceStrategy in
                                    TensorFlow. Making distributed training with TensorFlow or Keras
                                    as simple as invoking a function with your code in order to
                                    setup the cluster and start the training.</p>
                            </div>
                        </div>
                    </div>
                </uib-tab>
                <uib-tab index="2" heading="Spark"
                         ng-click="sparkConfigCtrl.changeTab('SPARK')">
                    <div class="row">
                        <div class="col-sm-8">
                            <h2 class="j-tab-heading">Spark</h2>
                            <p>Spark is a general-purpose cluster computing system.</p>
                            <md-radio-group ng-model="sparkConfigCtrl.sparkType">
                                <table class="button-table">
                                    <tbody>
                                    <tr>
                                        <td><md-radio-button value="SPARK_STATIC" class="md-primary">Spark (Static)</md-radio-button></td>
                                        <td><md-radio-button value="SPARK_DYNAMIC" class="md-primary">Spark (Dynamic)</md-radio-button></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </md-radio-group>
                            <div ng-include="'views/jupyter/sparkConfig.html'"></div>
                        </div>
                        <div class="col-sm-4 description">
                            <div ng-if="sparkConfigCtrl.sparkType == 'SPARK_STATIC'">
                                <p class="j-tab-advanced">Spark Static</p>
                                <p>When using Spark static you need to set number of executors.
                                    This means that your application will keep the resources it is allocated even if they are no
                                    longer used.</p>
                            </div>
                            <div ng-if="sparkConfigCtrl.sparkType == 'SPARK_DYNAMIC'">
                                <p class="j-tab-advanced">Spark Dynamic</p>
                                <p>With Spark dynamic you can set minimum and maximum number of executors.
                                    This means that your application may give resources back to the cluster if they are no
                                    longer used and request them again later when there is demand.</p>
                            </div>
                        </div>
                    </div>
                </uib-tab>
            </uib-tabset>
        </div>
    </div>
</div>